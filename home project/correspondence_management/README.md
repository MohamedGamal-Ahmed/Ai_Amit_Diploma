# نظام إدارة المراسلات
## Correspondence Management System

برنامج شامل لإدارة المراسلات الواردة والصادرة مع إمكانيات المتابعة والتقارير.

---

## المميزات الرئيسية

### 📥 إدارة المراسلات الواردة
- تسجيل وإدارة المراسلات الواردة
- تصنيف حسب الأولوية (عاجل، مهم، عادي)
- تتبع حالة المراسلة (جديد، قيد المراجعة، تم الرد، مؤرشف)
- البحث والفلترة المتقدمة

### 📤 إدارة المراسلات الصادرة
- إنشاء وإدارة المراسلات الصادرة
- ربط المراسلات الصادرة بالواردة
- تتبع حالة الإرسال والاستلام
- إدارة المسودات

### 📋 نظام المتابعة
- إضافة متابعات للمراسلات
- تحديد الإجراءات المطلوبة والمسؤولين
- تتبع حالة المتابعة
- تنبيهات للمتابعات المتأخرة

### 📊 التقارير والإحصائيات
- إحصائيات شاملة ومفصلة
- تقارير شهرية وسنوية
- رسوم بيانية تفاعلية
- تصدير التقارير

### 👥 إدارة المستخدمين
- نظام مستخدمين متعدد المستويات
- ثلاث مستويات صلاحيات: مدير، موظف، مشاهد
- سجل نشاطات المستخدمين
- إدارة كلمات المرور

### 🎨 واجهة حديثة
- تصميم عربي حديث وسهل الاستخدام
- ألوان مميزة لتصنيف المراسلات
- واجهة متجاوبة ومرنة

---

## متطلبات النظام

### البرمجيات المطلوبة
- Python 3.8 أو أحدث
- نظام التشغيل: Windows, macOS, Linux

### المكتبات المطلوبة
```bash
pip install matplotlib numpy Pillow openpyxl python-dateutil arabic-reshaper python-bidi
```

---

## التثبيت والتشغيل

### 1. تحميل البرنامج
```bash
# استنساخ المشروع أو تحميل الملفات
cd correspondence_management
```

### 2. تثبيت المتطلبات
```bash
pip install -r requirements.txt
```

### 3. تشغيل البرنامج
```bash
python run.py
```

أو

```bash
python main.py
```

---

## بيانات تسجيل الدخول الافتراضية

عند التشغيل الأول، سيتم إنشاء مستخدم المدير الافتراضي:

- **اسم المستخدم:** `admin`
- **كلمة المرور:** `admin123`

⚠️ **مهم:** يُنصح بتغيير كلمة المرور فور تسجيل الدخول الأول.

---

## هيكل البرنامج

```
correspondence_management/
├── main.py                 # الملف الرئيسي
├── run.py                  # ملف التشغيل
├── database.py             # إدارة قاعدة البيانات
├── auth.py                 # نظام المصادقة
├── requirements.txt        # المتطلبات
├── README.md              # هذا الملف
├── gui/                   # ملفات الواجهة
│   ├── __init__.py
│   ├── main_window.py     # النافذة الرئيسية
│   ├── login_window.py    # نافذة تسجيل الدخول
│   ├── incoming_tab.py    # تبويب المراسلات الواردة
│   ├── outgoing_tab.py    # تبويب المراسلات الصادرة
│   ├── followup_tab.py    # تبويب المتابعة
│   ├── reports_tab.py     # تبويب التقارير
│   └── users_tab.py       # تبويب المستخدمين
└── correspondence.db      # قاعدة البيانات (تُنشأ تلقائياً)
```

---

## الاستخدام

### 1. تسجيل الدخول
- استخدم بيانات المدير الافتراضية للدخول الأول
- يمكن إنشاء مستخدمين جدد من تبويب "إدارة المستخدمين"

### 2. إدارة المراسلات الواردة
- انتقل إلى تبويب "المراسلات الواردة"
- اضغط "إضافة مراسلة" لتسجيل مراسلة جديدة
- استخدم البحث للعثور على مراسلات محددة

### 3. إدارة المراسلات الصادرة
- انتقل إلى تبويب "المراسلات الصادرة"
- يمكن إنشاء مراسلة صادرة جديدة أو الرد على واردة

### 4. المتابعة
- أضف متابعات للمراسلات المهمة
- حدد الإجراءات المطلوبة والمسؤولين
- تابع حالة التنفيذ

### 5. التقارير
- اعرض الإحصائيات العامة
- أنشئ تقارير شهرية مفصلة
- اعرض الرسوم البيانية التفاعلية

---

## الصلاحيات

### مدير (Admin)
- جميع الصلاحيات
- إدارة المستخدمين
- عرض سجل النشاطات
- إنشاء النسخ الاحتياطية

### موظف (Employee)
- إضافة وتعديل المراسلات
- إدارة المتابعات
- عرض التقارير
- لا يمكن إدارة المستخدمين

### مشاهد (Viewer)
- عرض المراسلات فقط
- عرض التقارير
- لا يمكن التعديل أو الإضافة

---

## النسخ الاحتياطي

### إنشاء نسخة احتياطية
1. من قائمة "ملف" اختر "نسخة احتياطية"
2. حدد مكان الحفظ
3. سيتم حفظ ملف قاعدة البيانات

### استعادة النسخة الاحتياطية
1. من قائمة "ملف" اختر "استعادة"
2. اختر ملف النسخة الاحتياطية
3. ستتم استعادة البيانات

---

## استكشاف الأخطاء

### مشاكل شائعة وحلولها

#### 1. خطأ في تشغيل البرنامج
```bash
# تأكد من تثبيت المتطلبات
pip install -r requirements.txt

# تشغيل البرنامج
python run.py
```

#### 2. مشاكل في الخطوط العربية
- تأكد من وجود خط "Arial Unicode MS" في النظام
- أو استخدم خط "Tahoma" كبديل

#### 3. مشاكل في قاعدة البيانات
- احذف ملف `correspondence.db` لإعادة إنشاء قاعدة البيانات
- سيتم إنشاء المستخدم الافتراضي تلقائياً

#### 4. مشاكل في الرسوم البيانية
```bash
# تأكد من تثبيت matplotlib
pip install matplotlib numpy
```

---

## التطوير والتخصيص

### إضافة مميزات جديدة
- يمكن إضافة تبويبات جديدة في `gui/`
- تعديل قاعدة البيانات في `database.py`
- إضافة صلاحيات جديدة في `auth.py`

### تخصيص الواجهة
- تعديل الألوان والخطوط في ملفات GUI
- إضافة أيقونات مخصصة
- تغيير تخطيط النوافذ

---

## الدعم والمساعدة

### للحصول على المساعدة
- راجع هذا الملف للتعليمات الأساسية
- تحقق من رسائل الخطأ في وحدة التحكم
- تأكد من تثبيت جميع المتطلبات

### الإبلاغ عن المشاكل
- وصف المشكلة بالتفصيل
- إرفاق رسالة الخطأ إن وجدت
- ذكر نظام التشغيل وإصدار Python

---

## معلومات إضافية

### الأمان
- كلمات المرور مشفرة باستخدام SHA-256
- سجل نشاطات شامل لجميع العمليات
- صلاحيات محددة لكل مستوى مستخدم

### الأداء
- قاعدة بيانات SQLite سريعة ومحلية
- فهرسة للبحث السريع
- تحميل البيانات عند الطلب

### التوافق
- يعمل على جميع أنظمة التشغيل
- واجهة عربية كاملة
- دعم للنصوص من اليمين لليسار

---

**تم تطوير هذا البرنامج بواسطة AI Assistant**  
**© 2025 - جميع الحقوق محفوظة**